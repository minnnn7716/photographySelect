import{_ as k,m as u,d as N,r as m,o as l,c,a as t,t as o,f as p,g as h,F as b,e as g,h as y,i as v,s as $,w as r,n as T,j as D,b as C,v as j}from"./index-8558fa27.js";import{c as w,p as S}from"./cartStore-1dac39a8.js";import{t as V}from"./toastStore-57ead6d4.js";import{_ as L}from"./icon-copy-beec1672.js";const M={data(){return{tempCouponCode:""}},watch:{cartsData:"nothingInCart"},methods:{...u(w,["nothingInCart","updatedCart","deleteCart","useCoupon","nextStep"]),...u(S,["routerPush"]),...u(V,["pushMsg"]),availableNum(e){const{totalNum:d,soldNum:f}=e.product;return d-f},sendCoupon(){this.useCoupon(this.tempCouponCode),this.tempCouponCode=""},copyText(){const e=this.$refs.discount;navigator.clipboard.writeText(e.textContent),this.pushMsg({style:"success",title:"已複製優惠碼"})}},computed:{...N(w,["step","cartsData","discountPrice","couponData","couponCode","isLoading"])}},P={class:"container pt-2 pt-lg-8"},q={class:"d-flex align-items-center justify-content-between mb-2 mb-md-6 mb-lg-10"},O={class:"d-flex align-items-end"},U=t("h2",{class:"font-serif-en fs-display-7 fs-md-display-6"},"Cart",-1),B={class:"fw-light fs-5 fs-md-4 pb-3 ps-2"},F={class:"row font-sans-tw gx-10"},I={class:"col-12 col-lg-8 mb-6 mb-lg-0"},R=D('<div class="row fs-6 fs-md-5 text-gray-800 fw-light d-none d-md-flex"><div class="col">商品</div><div class="col-2 text-center">數量</div><div class="col-2 text-center">總價</div><div class="col-1"><span class="visually-hidden">刪除</span></div></div>',1),z={class:"col-9 col-md d-flex"},A=["onClick"],E=["src","alt"],G={class:"d-flex flex-column justify-content-between"},H={class:"fs-6 fs-md-5 fw-light mb-2"},J=["onClick"],K={class:"fs-normal-1 fs-md-6"},Q={class:"d-md-none"},W={class:"col-3 col-md-2 d-flex flex-column align-items-end align-items-md-center justify-content-between justify-content-md-center"},X=["onClick"],Y=t("div",{class:"icon-close"},null,-1),Z=[Y],tt=["for"],et=["id","onUpdate:modelValue","onChange"],st=["value","selected"],ot={class:"d-none d-md-flex col-2 d-flex align-items-center justify-content-center"},nt={class:"d-none d-md-flex col-1 d-flex align-items-center justify-content-center"},dt=["onClick"],lt=t("div",{class:"icon-close"},null,-1),ct=[lt],at={class:"col-12 col-lg-4"},rt={class:"card border-gray-800"},it=t("div",{class:"card-header bg-gray-800"},[t("h4",{class:"text-center text-white fs-5 fs-md-4 fw-normal"},"總計")],-1),ut={class:"card-body fw-light"},pt={class:"list-unstyled fs-6 fs-md-5 border-bottom border-gray-400 mb-0"},ft={class:"d-flex align-items-center justify-content-between mb-4"},_t=t("h5",{class:"fs-6 fs-md-5 fw-light"},"商品總數",-1),mt={class:"d-flex align-items-center justify-content-between mb-4"},ht=t("h5",{class:"fs-6 fs-md-5 fw-light"},"小計",-1),bt={key:0,class:"d-flex align-items-center justify-content-between mb-4 text-primary-700 fw-normal"},gt=t("h5",{class:"fs-6 fs-md-5"},"折價券",-1),yt={class:"py-6 border-bottom border-gray-400"},vt={class:"d-flex align-items-center mb-4"},Ct=t("p",{class:"fw-normal"},"限時全品項 8 折",-1),wt={class:"d-flex rounded-pill overflow-hidden border border-2 border-gray-900 mx-2"},xt={class:"d-flex align-items-center bg-dark text-white fs-normal-1 ps-3 pe-2 py-1",ref:"discount"},kt=t("img",{src:L,alt:"複製"},null,-1),Nt=[kt],$t={class:"d-flex align-items-center mb-3"},Tt=t("label",{for:"coupon",class:"me-3 w-20"},"折價券",-1),Dt={class:"input-group flex-fit"},jt=["disabled"],St={key:0,class:"fw-medium text-primary-700"},Vt={class:"fs-3 fs-md-2 fw-light text-center pt-4 pb-2 pt-md-5 pb-md-3"};function Lt(e,d,f,Mt,i,a){const _=m("RouterLink"),x=m("LoadingOverlay");return l(),c("div",P,[t("div",q,[t("div",O,[U,t("p",B,"("+o(e.cartsData.itemsNum)+")",1)]),p(_,{to:"/products",class:"btn-custom-light d-none d-lg-inline-block"},{default:h(()=>[C("返回購物")]),_:1})]),t("div",F,[t("div",I,[R,(l(!0),c(b,null,g(e.cartsData.carts,s=>(l(),c("div",{key:`購物車 ${s.title}`,class:"row align-items-md-center fs-6 fs-md-5 text-gray-800 fw-light py-5 border-bottom border-black"},[t("div",z,[t("a",{href:"#",onClick:r(n=>e.routerPush(s.product_id),["prevent"]),class:"cart-img me-4"},[t("img",{class:"img-full",src:s.product.imagesUrl[0],alt:s.product.title},null,8,E)],8,A),t("div",G,[t("div",null,[t("h3",H,[t("a",{href:"#",onClick:r(n=>e.routerPush(s.product_id),["prevent"]),class:"text-gray-800"},o(s.product.title),9,J)]),p(_,{to:"/products",class:"text-gray-800"},{default:h(()=>[C(o(s.product.author),1)]),_:2},1024)]),t("div",K,[t("p",null,"單價 NT "+o(e.$filters.currency(s.product.price)),1),t("p",Q,"總價 NT "+o(e.$filters.currency(s.total)),1)])])]),t("div",W,[t("button",{type:"button",class:"d-md-none btn p-0 border-0",onClick:n=>e.deleteCart(s.id)},Z,8,X),t("label",{class:"d-none",for:`${s.product.id}productNum`},"數量",8,tt),v(t("select",{class:"cart-numSelect form-select rounded-0 border-gray-800 text-center",name:"productNum",id:`${s.product.id}productNum`,"onUpdate:modelValue":n=>s.qty=n,onChange:n=>e.updatedCart(s.id,s.product_id,s.qty)},[(l(!0),c(b,null,g(a.availableNum(s),n=>(l(),c("option",{value:n,key:`數量 ${n}`,selected:n==s.qty},o(n),9,st))),128))],40,et),[[j,s.qty]])]),t("div",ot," NT$ "+o(e.$filters.currency(s.total)),1),t("div",nt,[t("button",{type:"button",class:"btn p-2 border-0",onClick:n=>e.deleteCart(s.id)},ct,8,dt)])]))),128))]),t("div",at,[t("div",rt,[it,t("div",ut,[t("ul",pt,[t("li",ft,[_t,t("p",null,o(e.cartsData.totalNum)+" 項",1)]),t("li",mt,[ht,t("p",null,"NT$ "+o(e.$filters.currency(e.cartsData.total)),1)]),e.couponCode!==""?(l(),c("li",bt,[gt,t("p",null,"-NT$ "+o(e.$filters.currency(e.discountPrice)),1)])):y("",!0)]),t("div",yt,[t("div",vt,[Ct,t("div",wt,[t("span",xt," photo_2023 ",512),t("button",{type:"button",class:"d-flex align-items-center ps-2 pe-3 py-1 border-0",onClick:d[0]||(d[0]=(...s)=>a.copyText&&a.copyText(...s))},Nt)])]),t("div",$t,[Tt,t("div",Dt,[v(t("input",{id:"coupon",type:"text",class:"form-control bg-gray-300 py-3",placeholder:"請輸入優惠碼","onUpdate:modelValue":d[1]||(d[1]=s=>i.tempCouponCode=s)},null,512),[[$,i.tempCouponCode,void 0,{trim:!0}]]),t("button",{class:"btn btn-gray-800 fw-light",type:"button",onClick:d[2]||(d[2]=r((...s)=>a.sendCoupon&&a.sendCoupon(...s),["prevent"])),disabled:i.tempCouponCode===""}," 送出 ",8,jt)])]),e.couponCode!==""?(l(),c("p",St," 已使用折價券 "+o(e.couponCode),1)):y("",!0)]),t("h4",Vt," NT$ "+o(e.$filters.currency(Math.floor(Math.floor(e.cartsData.final_total)))),1)]),t("a",{onClick:d[3]||(d[3]=r(s=>e.nextStep("cart"),["prevent"])),class:T(["fs-5 fs-md-4 btn btn-primary-400 fw-light rounded-0 rounded-bottom py-3",{"pe-none opacity-50":Object.prototype.hasOwnProperty.call(e.cartsData,"carts")?!e.cartsData.carts.length:!1}])}," 下一步 ",2)])])]),p(x,{active:e.isLoading},null,8,["active"])])}const Bt=k(M,[["render",Lt]]);export{Bt as default};
