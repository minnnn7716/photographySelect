import{m as g,_ as y,o as l,c as d,a as e,t as s,h as c,b as m,F as x,e as O,d as C,r as u,f as b}from"./index-8558fa27.js";import{D,a as f,_ as v}from"./icon-trashcan-7a2a02a4.js";import{o as w}from"./orderStore-efcbc4d0.js";import{m as N}from"./modalMixin-b8f36e48.js";import{o as T}from"./orderMixin-3db2fe2f.js";import"./adminProductStore-143ddc0f.js";import"./toastStore-57ead6d4.js";const L={data(){return{modal:"",tempOrder:{user:{}}}},props:{order:{type:Object,default(){return{}}}},mixins:[N,T],watch:{order(){this.tempOrder=this.order}},methods:{...g(w,["dueDate","isCancel"])},computed:{products(){if(this.tempOrder.products===void 0)return{};const t=Object.keys(this.tempOrder.products),n=[];return t.forEach(a=>{n.push(this.tempOrder.products[a])}),n},discountPrice(){let t=0;return this.products.length&&(t=this.products.map(a=>a.total).reduce((a,p)=>a+p)-Math.floor(this.tempOrder.total)),t}}},S={class:"modal fade",id:"orderModal",tabindex:"-1",ref:"modal"},j={class:"modal-dialog modal-dialog-scrollable modal-xl modal-dialog-centered"},P={class:"modal-content"},A=e("div",{class:"modal-header bg-primary-400"},[e("h2",{class:"modal-title fs-5",id:"orderModal"},"訂單資訊"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1),V={class:"modal-body"},B={class:"container"},E={class:"mb-6 mb-lg-12"},F={class:"row"},q={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},z=e("p",{class:"me-6 text-gray-500"},"編號",-1),G={class:"flex-grow-1"},H={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},I=e("p",{class:"me-6 text-gray-500"},"日期",-1),J={class:"flex-grow-1"},K={class:"col-12 col-lg-6 py-4 d-flex border-gray-400"},Q=e("p",{class:"me-6 text-gray-500"},"總額",-1),R={class:"flex-grow-1"},U={class:"col-12 col-lg-6 py-4 d-flex border-gray-400"},W=e("p",{class:"me-6 text-gray-500"},"狀態",-1),X={class:"flex-grow-1"},Y={key:0},Z={key:1,class:"text-gray-700"},ee={key:2,class:"text-danger fw-medium"},te={key:3,class:"text-danger fw-medium mt-1"},se={class:"mb-6 mb-lg-12"},oe=e("h3",{class:"fs-5 fw-medium"},"寄送資訊",-1),re={class:"row"},le={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},de=e("p",{class:"me-6 text-gray-500"},"姓名",-1),ce={class:"flex-grow-1"},ne={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},ae=e("p",{class:"me-6 text-gray-500"},"電話",-1),ie={class:"flex-grow-1"},_e={class:"col-12 py-4 d-flex border-bottom border-gray-400"},pe=e("p",{class:"me-6 text-gray-500"},"信箱",-1),he={class:"flex-grow-1"},me={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},ue=e("p",{class:"me-6 text-gray-500"},"取貨",-1),be={class:"flex-grow-1"},ge={class:"col-12 col-lg-6 py-4 d-flex border-bottom border-gray-400"},fe=e("p",{class:"me-6 text-gray-500"},"付款",-1),ye={class:"flex-grow-1"},xe={class:"col-12 py-4 d-flex border-bottom border-gray-400"},Oe=e("p",{class:"me-6 text-gray-500"},"地址",-1),ve={class:"flex-grow-1"},we={class:"col-12 py-4 d-flex border-bottom border-gray-400"},$e=e("p",{class:"me-6 text-gray-500"},"發票",-1),Me={class:"flex-grow-1"},ke={key:0},Ce={class:"col-12 py-4 d-flex"},De=e("p",{class:"me-6 text-gray-500"},"備註",-1),Ne={class:"flex-grow-1"},Te=e("h3",{class:"fs-5 fw-medium"},"訂單明細",-1),Le={class:"table-responsive"},Se={class:"admin-table table align-middle"},je=e("thead",null,[e("tr",null,[e("th",{class:"fs-normal-1 text-gray-500 fw-light border-bottom-0 pb-0"},"品名"),e("th",{class:"fs-normal-1 text-gray-500 fw-light text-end border-bottom-0 pb-0"}," 單價 "),e("th",{class:"fs-normal-1 text-gray-500 fw-light text-end border-bottom-0 pb-0"}," 數量 "),e("th",{class:"fs-normal-1 text-gray-500 fw-light text-end border-bottom-0 pb-0"}," 總額 ")])],-1),Pe={class:"text-end"},Ae={class:"text-end"},Ve={class:"text-end"},Be={class:"text-end"},Ee={key:0},Fe={colspan:"3",class:"border-bottom-0"},qe={class:"fs-normal-1 text-gray"},ze={class:"border-bottom-0"},Ge={colspan:"4",class:"fs-5 border-bottom-0"},He={class:"fs-3"};function Ie(t,n,a,p,o,i){return l(),d("div",S,[e("div",j,[e("div",P,[A,e("div",V,[e("div",B,[e("div",E,[e("div",F,[e("div",q,[z,e("p",G,s(o.tempOrder.id),1)]),e("div",H,[I,e("p",J,s(t.$filters.date(o.tempOrder.create_at)),1)]),e("div",K,[Q,e("p",R,"NT$ "+s(t.$filters.currency(o.tempOrder.total)),1)]),e("div",U,[W,e("div",X,[o.tempOrder.is_paid?(l(),d("p",Y,"已付款")):c("",!0),!o.tempOrder.is_paid&&t.isCancel(o.tempOrder.create_at)?(l(),d("p",Z," 已取消 ")):c("",!0),!o.tempOrder.is_paid&&!t.isCancel(o.tempOrder.create_at)?(l(),d("p",ee," 未付款 ")):c("",!0),o.tempOrder.is_paid?c("",!0):(l(),d("p",te," 期限至 "+s(`${t.dueDate(o.tempOrder.create_at).toLocaleDateString()} 23:59`),1))])])])]),e("div",se,[oe,e("div",re,[e("div",le,[de,e("p",ce,s(o.tempOrder.user.name),1)]),e("div",ne,[ae,e("p",ie,s(o.tempOrder.user.tel),1)]),e("div",_e,[pe,e("p",he,s(o.tempOrder.user.email),1)]),e("div",me,[ue,e("p",be,s(o.tempOrder.user.takeout),1)]),e("div",ge,[fe,e("p",ye,s(o.tempOrder.user.pay),1)]),e("div",xe,[Oe,e("p",ve,s(o.tempOrder.user.address),1)]),e("div",we,[$e,e("p",Me,[m(s(o.tempOrder.user.bill)+" ",1),o.tempOrder.user.bill==="電子載具"?(l(),d("span",ke,s(o.tempOrder.user.billNum),1)):c("",!0)])]),e("div",Ce,[De,e("p",Ne,s(o.tempOrder.message),1)])])]),e("div",null,[Te,e("div",Le,[e("table",Se,[je,e("tbody",null,[(l(!0),d(x,null,O(i.products,_=>(l(),d("tr",{key:`orderModal ${_.id}`},[e("td",null,s(_.product.title),1),e("td",Pe,"NT$ "+s(t.$filters.currency(_.product.price)),1),e("td",Ae,s(_.qty),1),e("td",Ve,"NT$ "+s(t.$filters.currency(_.total)),1)]))),128))]),e("tfoot",Be,[t.coupon.title!==""?(l(),d("tr",Ee,[e("td",Fe,[m(" 折價卷 "),e("p",qe,s(t.coupon.title),1)]),e("td",ze,"- NT$ $"+s(t.$filters.currency(i.discountPrice)),1)])):c("",!0),e("tr",null,[e("td",Ge,[m(" NT$ "),e("span",He,s(t.$filters.currency(o.tempOrder.total)),1)])])])])])])])])])])],512)}const Je=y(L,[["render",Ie]]),$="/photographySelect/assets/icon-search-54c9c32e.svg",Ke={data(){return{tempOrder:{},tempDelOrder:{},source:"Order"}},components:{DeleteModal:D,OrderModal:Je},methods:{...g(f,["getOrders","deleteOrder"]),...g(w,["dueDate","isCancel"]),openModal(t,n){t==="deleteModal"?this.tempDelOrder={id:n.id,source:this.source}:this.tempOrder={...n},this.$refs[t].showModal()}},computed:{...C(f,["orders","orderTotalPrice","orderNum","isLoading"])},created(){this.getOrders()}},Qe={class:"container-fluid"},Re={class:"row justify-content-center pt-6 pt-lg-10"},Ue={class:"col-12 col-lg-11"},We={class:"d-flex flex-column flex-lg-row justify-content-between align-items-lg-center mb-6 mb-lg-10"},Xe=e("h3",{class:"fs-3 fw-normal mb-4 mb-lg-0"},"顧客訂單",-1),Ye={class:"d-flex align-items-center"},Ze=e("span",{class:"mx-2"},"｜",-1),et={class:"table-responsive"},tt={class:"admin-table table table-hover align-middle font-sans-tw mb-12"},st=e("thead",null,[e("tr",{class:"fs-normal-1"},[e("th",{scope:"col",class:"d-lg-none p-0",style:{width:"50px"}},[e("span",{class:"d-none"},"操作按鈕")]),e("th",{scope:"col",class:"fw-normal text-gray"},"訂購日期"),e("th",{scope:"col",class:"fw-normal text-center text-gray"},"訂單編號"),e("th",{scope:"col",class:"fw-normal text-center text-gray"},"訂購人"),e("th",{scope:"col",class:"fw-normal text-center text-gray"},"總金額"),e("th",{scope:"col",class:"fw-normal text-center text-gray"},"付款狀態"),e("th",{scope:"col",class:"d-none d-lg-table-cell fw-normal w-15"},[e("span",{class:"d-none"},"操作按鈕")])])],-1),ot={class:"d-lg-none px-0 py-1"},rt=["onClick"],lt=e("img",{src:$,alt:"查看"},null,-1),dt=[lt],ct=["onClick"],nt=e("img",{src:v,alt:"刪除"},null,-1),at=[nt],it={class:"text-center"},_t={class:"text-center"},pt={class:"text-center"},ht={class:"text-center fw-medium"},mt={key:0},ut={key:1,class:"text-gray-500"},bt={key:2,class:"text-danger"},gt={class:"text-end d-none d-lg-table-cell"},ft=["onClick"],yt=e("img",{src:$,alt:"查看"},null,-1),xt=[yt],Ot=["onClick"],vt=e("img",{src:v,alt:"刪除"},null,-1),wt=[vt];function $t(t,n,a,p,o,i){const _=u("LoadingOverlay"),M=u("OrderModal"),k=u("DeleteModal");return l(),d("div",null,[e("div",Qe,[e("div",Re,[e("div",Ue,[e("header",We,[Xe,e("div",Ye,[e("p",null,"總金額 NT$ "+s(t.$filters.currency(t.orderTotalPrice)),1),Ze,e("p",null,"總筆數 "+s(t.$filters.currency(t.orderNum))+" 筆",1)])]),e("section",null,[e("div",et,[e("table",tt,[st,e("tbody",null,[(l(!0),d(x,null,O(t.orders,r=>(l(),d("tr",{key:`orders ${r.id}`},[e("td",ot,[e("button",{type:"button",class:"btn border-0 px-1",onClick:h=>i.openModal("orderModal",r)},dt,8,rt),e("button",{type:"button",class:"btn border-0 px-1",onClick:h=>i.openModal("deleteModal",r)},at,8,ct)]),e("td",null,s(t.$filters.date(r.create_at)),1),e("td",it,s(r.id),1),e("td",_t,s(Object.prototype.hasOwnProperty.call(r,"user")?r.user.name:""),1),e("td",pt,"NT$ "+s(t.$filters.currency(r.total)),1),e("td",ht,[r.is_paid?(l(),d("span",mt,"已付款")):c("",!0),!r.is_paid&&t.isCancel(r.create_at)?(l(),d("span",ut,"已取消")):c("",!0),!r.is_paid&&!t.isCancel(r.create_at)?(l(),d("span",bt,"未付款")):c("",!0)]),e("td",gt,[e("button",{type:"button",class:"btn border-0 btn-custom-hover-scale",onClick:h=>i.openModal("orderModal",r)},xt,8,ft),e("button",{type:"button",class:"btn border-0 btn-custom-hover-scale",onClick:h=>i.openModal("deleteModal",r)},wt,8,Ot)])]))),128))])])])])])])]),b(_,{active:t.isLoading},null,8,["active"]),b(M,{ref:"orderModal",order:o.tempOrder},null,8,["order"]),b(k,{ref:"deleteModal",deleteData:o.tempDelOrder},null,8,["deleteData"])])}const St=y(Ke,[["render",$t]]);export{St as default};
